 The following content is provided under a Creative Commons license. Your support will help MIT OpenCourseWare continue to offer high-quality educational resources for free. To make a donation or to view additional materials from hundreds of MIT courses, visit MIT OpenCourseWare at ocw.mit.edu. So today, we are going to continue looking at critical points.  how to actually decide whether a critical point is a minimum and a maximum, or a saddle point. So that's the main topic for today. So remember, yesterday we looked at critical points of functions of several variables. And so a critical point of a function, say, of two variables x and y,  that's a point where the partial derivatives are both 0. And we've seen that, first, various kinds of critical points, there's local minima. So maybe I should show the function and its contour plot. There's local maxima, which are like that, and there's a set of elements  points, which are neither minimum or maximal. And, of course, if you have a real function, then it will be more complicated. It will have several critical points. So this example here, well, you see on the plot that there's two maximal, and there's in the middle between them, there's a saddle point.  And actually, you can see them on the contour plots. On the contour plots, you see the maxima because the level curves become circles that narrow down and shrank to the maximum. And you can see the subtle point because here you have this level curve that makes a figure of 8. It crosses itself. And if you move up or down here, then, so along the y direction, the values of the function will decrease, along the x direction, the values will  increase. So you can see, usually quite easily, where are the critical points, just by looking either at the graph or at the contour plot. So the only thing with the contour plot is you need to read the values to tell a minimum from a maximum, because the contour plots look the same, just, of course, in one case, the values increase and differ when they decrease. So the question is,  So, the question is how do we decide between the very  And in fact, why do we care? Well, the other question is, how do we find the global minimum or maximum of a function?  So here already I should point out, well, first of all, you know, to decide where the function is the largest. In general, you'll have actually to compare the values. For example, here, if you want to know what is the maximum of this function? Well, we have two obvious candidates. We have this local maximum and that local maximum. And the question is, which one is the higher of the two? Well, in this case, actually, they're exactly tied for maximum.  And generally, you would have to compute the function at both points and compare the values if you know that it's free at one of them and far at the other, well, for wins. The other thing that you see here is if you're looking for the minimum of this function, well, the minimum is not going to be at any of the critical points. So, where's the minimum? Well, it looks like the minimum is actually out there on the boundary or at infinity. So, that's another feature of a global minimum or maximum. Doesn't have to be at the critical point.  somehow on the side, in some limiting situation, where one variable stops being in the allowed range of values or goes to infinity. So we have to actually check the boundary and the infinity behavior of our function to know where, actually, the minimum and maximum will be. So in general, should point out, these could occur,  either at a critical point or on the boundary or at infinity. So by that I mean on the boundary of a domain of definition that we are considering.  And we get back to that. For now, let's try to focus on the question of, what's the type of the critical point? So we'll use something that's known as the second derivative test. And in principle, well, the idea is kind of similar to what you do with a function of one value.  namely, function of one variable, if the derivative is 0, then you know that you should look at the second derivative. And that will tell you whether it's curving up or down, whether you have a local max and a local min. And the main problem here is, of course, we have more possible situations, and we have several derivatives. So, actually, we have to think a bit harder about how we'll decide. But it will, again, involve the second derivatives. OK, so let's start with just an easy example.  that will be useful to us because actually it will provide the basis for the general method. OK, so we are first going to consider a case where we have a function that's actually just quadratic. So let's say I have a function, w of xy, that's of a form a x squared plus b xy plus c y squared. OK, so this guy has a critical point at the point where we have a function  the origin, because if you take the derivative with respect to x, well, and if you plug x equals y equals 0, you'll get 0. And same with respect to y. You can also see if you try to do a linear approximation of this, well, all these guys are much smaller than x and y, when x and y are small. So the linear approximation, the tangent plane to the graph, is where they trust, w equals 0. OK, so how do we do it?  Yesterday, which we did an example, it was a bit more complicated than that, but let me do it. So remember, we were looking at something that started with x squared plus 2xy plus 3y squared. And there were other terms, but let's forget them now. And what we did is we said, well, we can rewrite this as x plus y squared plus 2y squared.  have two squares, so each of these guys has to be non-negative, and so the origin will be a minimum. Well, turns out we can do something similar in general, no matter what these values of a, b and c are. We'll just try to first complete things to a square. OK, so let's do that. So in general, well, let me be slightly less general, and let's  let me assume that a is nonzero, because otherwise I can't do what I'm going to do. So I'm going to write this as a times x squared plus b over a xy, then I have my c y squared. And now this looks like the beginning of the square of something, OK?  over there. So what is it the square of? Well, it starts with x plus, and claim if I put b over 2a times y, and I square, then, see the term, the closed term, 2 times x times b over 2ay will become b over a xy. Of course, now I also get some y squares out of this.  So, what else do I get? Well, I get b squared over 4a squared times a, so I get b square over 4a y squared. And I want, in fact, c times y squared. So, the number of y squared that I should add is c minus b squared over 4a. OK, let's see that again. If I expand this thing, I will get ax squared plus a times b.  b over 2a times 2 xy, that's going to be my b xy, but I also get b squared over 4a squared, y squared times a. That's b squared over 4a, y squared. And that cancels out with this guy here, and then I will be left with c y squared. OK, do you see it? Kind of. OK, if not well, try expanding this square again.  OK, maybe I'll do it, just to convince you. So if I expand this, I will get a times, let me put that in a different color, because if you shouldn't write that down, it's just to convince you again. So if you don't see it yet, let's expand this thing. We'll get a times x squared plus a times x minus x.  x be over 2ay, well, the 2a's cancel out. We get b xy, plus a times the square of that. That's going to be b squared over 4a squared, y squared, plus c y squared, minus b square over 4a y squared.  And now, these two terms simplify and give me just cy squared in the end. OK, and that's kind of unreadable after I've canceled everything.  yourself, I'm afraid. OK, so let me continue to play with this. So I'm just going to put this in a slightly different form, just to clear the denominators. OK, so I will, instead, write this as 1 over 4a times a big thing. So I'm going to just put 4,  x plus b over 2Ay squared, OK, so so far I have the same thing as here. OK, I just introduced a 4A that cancels out. Plus, for the other one, I'm just clearing it in the minute there. I end up with 4Ac minus b squared y squared. OK, so that's a lot of terms.  but what does it look like? Well, it looks like, so we have some constant factors, and here we have a square, and here we have a square. So, basically, we've written this as a sum of two squares. Well, a sum or a difference of two squares, and maybe that's what we need to figure out, to know what kind of point it is, because, see, if you take a sum of two squares, then you'll know that each square takes non-negative values,  have the function will always take non-negative values. So the origin will be a minimum. If you have a difference of two squares, then typically you'll have a saddle point because depending on whether one of the other is larger, you'll have a positive or a negative quantity. So I claim there's various cases to look at. So let's see.  So, in fact, I claim there will be three cases, and that's good news for us because, after all, we want to distinguish between three possibilities. So, let's first do away with the most complicated one. What if for a c minus b squared is negative? Well, if that's negative, then it means what I have between the brackets,  So the first guy is, obviously, a positive quantity, while the second one will be something negative times y squared, so it will be a negative quantity. OK, so one term is positive, the other is negative that tells us we actually have a saddle point.  We have in fact written our function as a difference of two squares. OK, is that convincing? So if you want, what I could do is actually I could change my coordinates, have new coordinates, I don't know, u equals x plus b over 2a, y, and, actually, well, I could keep y, and then it would look like a difference of squares directly. OK, so that's,  first case. The second case is where 4ac minus b squared equals 0. Well, what happens if that's 0, then it means that this term over there goes away. So what we have is just one square. So what that means is actually that our function depends only on which  direction of things. In the other direction, it's going to actually be degenerate. So, for example, forget all the clutter in there. Say I give you just the function of two variables, w equals just x squared. So that means it doesn't depend on y at all. And if I try to plot the graph, it will look, well, x is here.  x in that way, but it doesn't depend on y at all. So what the graph looks like is something like that. Basically, it's a value, whose bottom is completely flat. So that means, actually, we have a degenerate critical point. It's called degenerate, because there's a direction in which nothing happens.  point, every where, along the y-axis. So now, whether the square that we have is x, or something else namely, x plus b over 2ay, it doesn't matter. We'll still get this degenerate behavior that there's a direction in which nothing happens, because we just have the square of one quantity.  I'm sure that three hundred students means three hundred different ringtones, but I'm not eager to hear all of them. Thanks. OK. So this is what's called the degenerate critical point. And, OK,  So, basically, we leave it here. We won't actually try to figure out, for what happens, and the reason for that is that when you have an actual function, a general function, not just one that's quadratic like this, then there will actually be other terms, maybe involving higher powers, maybe x cubed or y cubed, or things like that. And then, there will mess up what happens in this value.  actually to tell, automatically just by looking at second derivatives what happens. See, for example, in the function of one variable, if you have just the function of one variable, say, f of x equals x to the 5, well, if you try to decide what type of point the origin is, you're going to take the second derivative, it will be 0, and then you can conclude, because things depend on higher order derivatives. So we just want like that case.  want to try to figure out what's going on here. Now, the last situation is if for a c minus b squared is positive. So then, that means that actually we've written things, the big bracket up there, is a sum of two squares. OK? So that means that we've written w as one of the big  over 4a times plus something squared. OK, so these guys have the same sign, and that means that this term here will always be greater or equal to 0. And so that means that we should have either a maximum or a minimum. How do we decide which one it is? Well, we look at the sign of a, exactly.  So there's two subcases. One is if a is positive, then this quantity, overall, will always be non-negative, and that means we have a minimum.  We multiply this positive quantity by a negative number. We get something that's always negative, so 0 is actually the maximum. OK, is that clear for everyone? Yes?  I said in the example, w equals x squared, it doesn't depend on y. So the marginal situation is w equals some constant, well, I guess it's a, x plus b over 2a times y squared. So it does depend on x and on y, but it only depends on this combination. So if I choose to move in somehow the perpendicular direction, in the direction where this remains constant.  x set x equals minus the other two AY, then this remains zero all the time. So there's a degenerate direction in which I stay at the minimum or maximum or whatever it is that I have. So that's why it's called degenerate.  very good question. So I say this going to be the second derivative test. Why do we not have derivatives yet? Well, that's because I've been looking at this special example where we have a function like this. And so I don't actually need to take derivatives yet. But that's secretly that's because a, b, and c will be the second derivatives of the function, actually, 2a, b, and 2c. So now we're going to go to a general function. And there, instead of having these coefficients a, b, and c given to us, we'll have to compute them as second derivatives.  So here, I'm basically setting the stage for what will be the actual criterion we'll use using second derivatives. So, yes, so when you have a degenerate critical point, it could be a degenerate minimum or a degenerate maximum depending on the sign of A. But in general, once you start having more complicated functions, you don't really know what will happen anymore.  So we won't really be able to tell. Yes?  see it here, because that doesn't happen if you have only quadratic terms like that. You need to have higher order terms to see it happen. OK. So let's continue. Oh, before we continue, let's see. I wanted to point out one small thing. So here we have this magic  quantity for a c minus b squared, you've probably seen that before in your life. Yeah, it looks like the chaotic formula, except that one involves b squared minus 4 a c, but that's really the same thing. OK, so let's see.  So we've manipulated things and gotten to a conclusion. But let me just do a different manipulation. And write this now instead as y squared times a times x over y squared plus b x over y plus c.  quantity here is always non-negative. What about this one? Well, of course, this one depends on x over y. It means it depends on which direction you're going to move away from the origin, which ratio between x and y you will consider. But I claim there's two situations. So let's try to reformulate things. So if this here is positive,  And it means that this has roots, this has solutions. And that means that this quantity can be both positive and negative. This quantity takes positive and negative values, one way to convince yourself,  is just to you know, plot, a is square plus bt plus c. You know that there's two roots. So it might look like this, or it might look like that, depending on the sign of a. But in either case, it will take values of both sides. So that means that your function will take values of both sides.  the value takes both positive and negative values. And so that means we have a saddle point. While the other situation, when b squared minus 4ac is negative,  means that this equation, this quadratic, never takes the value 0. So it's always positive or it's always negative depending on the sign of A. So the other case is if B2 minus 4ac is negative, then that quadratic doesn't have a solution. And it could look like this are like that depending on whether A is positive or A is negative.  So in particular, that means a x over y squared plus b x over y plus c is always positive or always negative, depending on the sign of a. And then that tells us that our function, w, will be always positive or always negative, and then we'll get a minimum or a maximum.  OK, we'll have a min or a max depending on which situation we are in. OK, so that's another way to derive the same answer. And now here you see why the discriminant plays a role.  or whether I can actually cross the value 0 when you have a root of a monotonic. OK, so hopefully at this stage you're happy with one of the two explanations at least. And now you're willing to believe, I hope, that we have basically a way of deciding what type of credible point we have.  in the special case of a quadratic function.  Now, what do we do with a general function? So, in general, we want to look at second derivatives. OK, so now we are getting to the real stuff. So, how many second derivatives do we have?  well, we can take the derivative first with respect to x, and then, again, with respect to x. OK? That gives us something we denote by partial square f of R partial x squared, or f sub xx. Then there's another one, which is f sub xy, which means you take the delta.  derivative with respect to x, and then with respect to y, another thing you can do is do first derivative with respect to y, and then with respect to x. That would be f sub yx. Well, good news. These are actually always equal to each other. OK, so it's a fact that we will admit. It's really not very hard to check. So these are always the same.  We don't need to worry about which one we do. That's one computation that we won't need to do. We can save a bit of effort. And then we have the last one, namely the second partial with respect to y and y, f sub yy. OK, so we have three of them.  what does the second derivative test say? It says, say that you have a radical point, x0, y0, of a function of two variables, f,  And then, let's compute the partial derivatives. So let's call capital A the second derivative with respect to x. Let's call capital B the second derivative with respect to x and y. And c equals f sub yy at this point. So these are just numbers, because we can first compute the second derivative with respect to x and y.  and then we plug in the values of x and y at the critical point. So this will just be numbers. And now what we do is we look at the quantity ac minus b squared. I am not forgetting a 4, you will see why there is some. So if ac minus b squared is positive,  then there's two subcases. If a is positive, then it's local minimum. The second case, so still if a, c minus b squared is positive, but a is negative, then it's going to be a local minimum.  So we call maximum. And if a c minus b squared is negative, then it's a saddle point. And finally, if a c minus b squared is 0, then we actually cannot conclude. We don't know whether it's going to be a minimum, a maximum, or a saddle.  x is a real number. We know it's degenerating some way, but we don't know what type of point it is. OK, so that's actually what you need to remember if you're formula-oriented. That's all you need to remember about today. But let's try to understand why, you know, how this comes out of what we had there. OK, so I think maybe I actually have a little  actually want to keep this middle world, because it actually has the recipe that we found before, for the quadratic function. So let me move directly over there, and try to relate our old recipe with a new one.  OK, you're easily amused. OK, so first let's check that these two things say the same thing.  So let's verify in the special case where the function was ax squared plus b xy plus c y squared. So what is the second derivative with respect to x and x?  x and x. So first I want to take maybe the derivative with respect to x, let's take first partial, w sub x, that will be 2ax plus By. So, w sub xx will be, well, let's take the partial respect to x again, but 2a.  b. OK, now we need also the partial of respect to y. So, w sub y is bx plus 2cy. In case you don't believe what I told you about the mixed partials, w sub yx, well, you can check, and it's again b. So, there, indeed, the same thing. And, w sub yy will be 2c.  So if we now look at these quantities, that tells us, well, big A is too little A. Big B is little B. Big C is too little C. So A c minus B squared is what we used to call 4 little A c minus B squared.  OK? So now you can compare the cases. Well, they're not listed in the same order, just to make it harder. So we say it first if, so the subtle case is when a c minus b squared in big letters is negative, that's the same as for a c minus b squared in lower case is negative. The case where capital ac minus b squared in lower case is negative,  b square is positive, local min and local max, corresponds to this one. And the case where we can't conclude was what used to be the degenerate one. OK, so at least we don't seem to have messed up when copying the formula. Now, why does that work marginally even that? Well, the answer to that is, again,  Taylor approximation. So let me just do here, quadratic approximation. So quadratic approximation tells me the following thing.  And I want to understand the change in f, when I change x and y a little bit. Well, there's the first order terms, there's the linear terms, but by now you should know and be comfortable with. That's f sub x times the change in x. And then there's f sub y times the change in y. OK, that's the starting point.  x and y, sorry, if we are at a critical point, then that's going to be 0 at a critical point. So that term actually goes away, and that's also 0 at the critical point. So that term also goes away. So linear approximation is really no good. We need more terms. So what are the next terms?  So the next terms are quadratic terms. And so, I mean, if you remember the Taylor formula for a function of a single variable, there was the derivative times x minus x0 plus 1-half of a second derivative times x minus x0 squared. And see, this side here is really Taylor approximation in one variable, looking only at x.  and these terms are f sub xy times changing x times changing y, plus 1-half of f yy times y minus y0 squared. There's no one-half in the middle, because in fact you would have two terms, 1 for xy, 1 for yx, but they're the same. And then if you want to continue, there's actually cubic terms involving the third derivatives and so on, but we are not  actually looking at them. And so now, when we do this approximation, well, the type of critical point remains the same when we replace the function by this approximation. And so we can apply the argument that we used to deduce things in the  So the general case reduces to the quadratic case.  So, this coefficient, which we use to call little a, is also one-half of capital A. And same here, this coefficient is what we call capital B, or little B. And this coefficient here is what we called little c, or one-half of capital C. And then, when you replace things into the limit,  there is cases that we had here, you end up with the second derivative test. So what about the degenerate case? Why can't we just say, well, it's going to be a degenerate critical point? So the reason is that this approximation formula is reasonable only if the higher order terms are negligible. So in fact, secretly, there's more terms. This is only an approximation. There would be terms involving third derivatives,  and maybe even beyond that. And so in the non-degenerate case, they don't actually matter, because the shape of the graph is actually determined by the quadratic terms. But in the degenerate case, see, if I start with this, and I add something even very, very small along the y axis, then that can be enough to bend this very slightly up or slightly down and turn my degenerate point into either a minimum or a saddle point.  And I won't be able to tell until I go further in the list of derivatives. So in the degenerate case, what actually happens, depends on the higher-order derivatives.  So we'd need to analyze things more carefully. Well, we're not going to bother with that in this class. So we'll just say, well, we cannot conclude. OK? I mean, you have to realize that in real life, you have to be extremely unlucky for this quantity to end up being exactly 0.  Well, if that happens, then what you should do is maybe try by inspection, see if there's a good reason why the function should always be positive or always be negative or something. Or, you know, plot it on a computer and see what happens. But otherwise, we can't conclude. OK, so let's do an example.  So probably I should leave this on so that we still have the test with us. And instead, OK, so I'll do my example here.  OK, so, let's do an example.  x plus y plus one of our xy, where x and y are positive. So I'm looking at the first quadrant. OK, I mean, I'm doing this because I don't want this denominator to become 0, so I'm just looking at that situation. So let's look first for, so the question will be what are the minimum and the maximum of this function. So the first thing we should do,  to end of it, to answer this question, is look for critical points. So for that we have to compute the first derivatives. So f sub x is 1 minus 1 of our  x squared y. Take the derivative of one over x, that's negative one over x squared. And we'll want to set that equal to 0. And f sub y is 1 minus one over xy squared, and we want to set that equal to 0. So, what are the equations we have to solve?  x x squared y equals 1. If I move this guy over here, I get one of our x squared y equals 1.  x equals y. And then if x equals y, then if I put that into here, it will give me y-cubed equals 1, which tells me y equals 1, and therefore x equals 1 as well. OK, so there's only one solution. There's only one critical point, which is going to be 1 comma 1. OK.  So now here's where you do a bit of work. What do you think of that critical point? OK, I see some valid votes. I see a lot of people answering four.  well, you haven't computed the second derivative yet. Yes, I see someone giving the correct answer. I see some people not giving quite the correct answer. I see more and more correct answers. OK, so let's see. To figure out what type of point it is, we should compute the second partial derivatives. OK, so x of xx is, what do we get when we take the derivative of this with respect to x?  x to x of x cubed y. So at our point, A will be two. x of xy will be one of x squared, y squared. So B will be one.  f sub yy is going to be one of, no, two of our xy-cute. So c will be two. And so that tells us, well, ac minus b squared is 4 minus 1. So I should probably use a different blackboard for that.  a c minus b squared is 2 times 2 minus 1 squared, is 3, is positive. That tells us where either a local minimum or a local maximum. And a is positive, so it's a local minimum. And in fact, we can check it's the global minimum. What about the maximum?  actually at a critical point. It's on the boundary or at infinity. So we have actually to check what happens when x and y go to 0 or go to infinity. Well, if that happens, if x or y goes to infinity, then the function goes to infinity. Also, if x or y goes to 0, then one of our xy goes to infinity. So the maximum, well, the function goes to infinity when x goes to infinity,  x and y go to 0. So it's not at a critical point. So, in general, we have to check both the critical points and the boundaries to decide what happens.