 The following content is provided under a Creative Commons license. Your support will help MIT OpenCourseWare continue to offer high-quality educational resources for free. To make a donation or to view additional materials from hundreds of MIT courses, visit MIT OpenCourseWare at ocw.mit.edu. So last time we saw things about gradients and directional derivatives,  Before that, we've studied how to look for minima and maxima functions of several variables. And today, we're going to look again at min max problems, but in a different setting, namely when the variables are not independent. And so what we'll see is the method of Lagrange multipliers. And this is the one point in the term when I can shine with my French accent and say Lagrange's name properly.  OK, so what are Lagrange multipliers about? Well, the goal is to minimize or maximize a function of several variables. Let's say, for example, f of x, y, z, three variables.  So, they are not independent. That means that there's a relation between them. The relation is maybe some equation of the form g of x, y, z equals some constant. OK, so you take the relation between x, y, z.  the goal is to minimize f, only of those values of x, y, z, that satisfy the constraint. So what's one way to do that? Well, one way to do that, if the constraint is very simple, we can maybe solve for one of the variables. OK, maybe we can solve this equation for one of the variables, plug back into f, and then we have a usual min max problem that we've seen how to do. The problem is, sometimes, you can't actually solve for x, y, z in here,  this condition is too complicated. And then we need a new method. And that's what we are going to do. OK? So why would we care about that? Well, one example is actually in physics. Maybe you've seen in thermodynamics that you study quantities about guesses. And those quantities that involve pressure, volume, and temperature. And pressure, volume and temperature, are not independent of each other. I mean, you know probably the equation pv equals nrt.  there you could actually solve to express things in terms of one or the other. But sometimes it's more convenient to really keep all three variables, but treat them as constraint. So, let's just an example of a situation where you might want to do this. Anyway, we'll look mostly at mathematical examples, but just to point out that this is useful when you study guesses in physics.  So the first observation is we can't use our usual method of looking for critical points of f, because critical points of f, typically, they will not satisfy this condition. So they won't be good solutions. We need something else. So let's look at an example, and we'll see how that leads us to the method. So for example, let's say that I want to find the point closer to the origin.  xy equals 3 in the plane. So that means I have this hyperbola, and I'm asking myself,  elementary geometric, we don't need actually Lagrange multipliers, but we are going to do it with Lagrange multipliers, because it's a pretty good example. So what does it mean? Well, it means really we want to minimize distance to the origin. So what's the distance to the origin? If I have a point that coordinates xy, then the distance to the origin is square root of x square plus y squared.  well, do we really want to minimize that? Or can we minimize something easier? Yeah, maybe we can minimize the square of a distance. OK, so let's forget this guy. And instead, so actually we'll minimize f of xy equals x squared plus y squared.  And we'll now check to the constraint xy equals 3, and so we'll call this thing g of xy, OK, to either straight the general method. So let's look at the picture. So here you can see in yellow the hyperbola xy equals 3.  and we're going to look for the points that are closest to the origin. So what can we do? Well, for example, we can plot the function x squared plus y squared, function f. That's the contour plot of f with a hyperbola on top of it. And now let's see what we can do with that. Well, let's ask ourselves, for example, if I look at points that are,  where f equals 20 now, I think I'm at 20, but you can really see it, that's a circle, that's the point whose distance square is 20, well, can I find, so do you find, when we hyperbola? Yes, there are four points at this distance. OK, can I do better? Well, let's decrease the distance. Yes, we can still find points in the hyperbola. And so on, well, except if we go too low, then there's no points on this circle anymore in the hyperbola.  that we look at, there's somehow a limit value, beyond which we can't go. And that's the minimum of f. So we're trying to look for the smallest value of f that will actually be realized on the hyperbola. So when does that happen? Well, I have to back-write a little bit. It seems like the limiting case is basically here. It's when the circle is tangent to the hyperbola.  that will hit the hyperbola. So if I take a larger value of f, I will have solutions. If I take a smaller value of f, I will not have any solutions anymore. So that's the situation that we want to solve for. So how do we find that minimum? Well, the key observation that's valid on this picture and that actually will remain true in the completely general case,  is that when we write the minimum, the level curve of f is actually tangent to our high power lower. It's tangent to our constraint to the set of points where xy equals 3, to the high power lower. OK, so let's write that down. We observe that at the minimum,  So the level curve of f is tangent to the hyperbola. And remember, the hyperbola is given by the equation g equals 3, so it's a level curve of g.  And I claim that's going to be the general situation that we're interested in. So, how do we look for, you know,  g are tangent to each other. Well, so let's think for a second. If the two-level curves are tangent to each other, that means that they have the same tangent line. Right? If they have the same tangent line, that means that the normal vectors should be parallel.  OK, let me draw a picture here. So this is the level curve, maybe f equals something. And this is the level curve, g equals constant. Here my constant is free. Well, if I look at the gradient vectors, so the gradient of f will be perpendicular to the level curve of f. The gradient of g will be perpendicular to the level curve of g.  OK, but we have to be parallel to each other. Of course, they could also be parallel, pointing in opposite directions. But the key point is that when this happens, the gradient of f is parallel to the gradient of g. Well, let's check that.  So here's a point, and I can plot the gradient of f in blue, the gradient of g in yellow. And you see in most of its places, somehow the two gradients are not really parallel. Actually, I shouldn't be looking at random points. They should be only on the hyperbola. Right? I want points on the hyperbola where the two gradients are parallel. Well, when does that happen? Looks like it will happen here.  minimum, the two gradient vectors are parallel. That's not really a proof. It's an example, but it seems to be convincing. So far, things work pretty well. OK, so how do we decide if two vectors are parallel? Well, they are parallel when they are proportional to each other. So you can write one of them as a constant times the other.  one. And that constant, usually, when uses the Greek letter Lambda, I don't know if you've seen it before, it's the Greek letter for L, and probably I'm sure that somebody is idea of paying a tribute to Lagrange by putting an L in there. Lambda is just a constant, and we are looking for a scalar, Lambda, and points x and y,  where this holds. So, in fact, what we are doing is we are replacing a min-max problem in two variables with a constraint between them by a set of equations involving, you will see, three variables. So, we had min-max with two variables, x and y, but not independent. We had a constraint, g of x, which is  xy equals constant, and that becomes something new, that becomes a system of equations, where we have to solve, well, so let's write down what it means for gradient f to be proportional to gradient g, that means that f sub x should be lambda times g sub x, and f sub 1 is less than x.  y should be lambda times g sub y. Right? Because the gradient vectors here are f sub x, f sub y, and g sub x, g sub y. If you have a third variable, z, then you have also an equation, f sub z equals lambda g sub z. Now, let's see. How many unknowns do we have in these equations? Well, there's x, there's y, and there's lambda. So we have three unknowns.  we have only two equations, something is missing. Well, yeah, I mean, x and y are not actually independent, they're related by the equation g of xy equals c. So we need to add the constraint, g equals c. And now we have three equations involving three variables. OK, let's see how that works.  x. So here, remember, we have f equals x squared plus y squared, and g equals xy. So what's f sub x? That's going to be 2x equals lambda times what is g sub x.  then we have f sub y equals lambda g sub y. So f sub y is 2y equals lambda times g sub y is x. And then our third equation, g equals c, becomes xy equals 3. So that's what we would have to solve. Any questions at this point?  xn is less than or equal to m.  and points towards higher values of a function. So it could be, where did I have them? Yeah, it could be that my gradient vectors up there actually point in opposite directions. It doesn't matter to me because it will still look the same in terms of the equation, just lambda will be positive or negative, depending on the case. So I can handle both situations. It's not a problem. So I can allow lambda to be positive.  are negative or negative, and well, in this example, it looks like lambda will be positive. If you look at the picture on the plot, yes? If you're trying to find from a hyperbola and the circles in a set, why can you set the two common people to the right? Well, because actually they're not equal to each other. If you look at, so if you look at this point where the hyperbola and the circle touch each other, so, first of all, I don't know which circle I'm going to look at.  I'm trying to solve actually for the radius of the circle. I'm trying to find what's the minimum value of f. And second, at that value of f, actually, at that point, the value of f and the value of g are not equal. g is equal to 3, because I'm on the hyperbola x for equals 3, the value of f will be the square of the distance, whatever that is. I think it will end up being 6, but we'll see. So you can't really set them equal, because you don't know what f is equal to in advance.  x. Yes?  equals constant. And what we are going to do for that is we're really going to say, instead, let's look at places where gradient f and gradient g are parallel to each other, and solve for equations of that. I think we completely lose the notion of closest point if we just look at these equations. We don't really say anything about closest points anymore. Of course, that's what they mean in the end. But in the general setting, there's no closest point involved in the animal.  x is also a sequence I wear, I want to ask you why I have a little bit of x.  x-cluster dimensions, it could even be a saddle point. And in fact, I should say in advance, this method will not tell us whether it's a minimum or a maximum. We don't have any way of knowing, except for testing values. We can't use second derivative tests or anything like that. OK, I'll get back to that. Yes? Why can you just set y equals 3 over n?  solve a more complicated problem, I might not be able to solve. So I'm doing an example where, indeed, here you could solve and remove one variable, but you can't always do that. And this method will still work. The other one will want. I don't see any other questions. Are there any other questions? Then I see a lot of use of them is tratching and so on. So it's very confusing for me.  OK, so how do we solve these equations? Well, the answer is in general we might be in deep trouble. OK, there's no general method for solving the equations that you get from this method. You just have to think about them. And so, you know, sometimes it will be very easy. Sometimes it will be so hard that you can actually do it with what a computer.  will be just hard enough to be on top B of this week's problem set. OK. So in this case, I claim in this case we can actually do it without so much trouble.  We can think of this as a 2x2 linear system in x and y. Well, let me do something. OK? So let me rewrite the first two equations as 2x minus lambda y equals 0, and lambda x minus 2y equals 0. OK, and xy equals 3.  right, that's what we want to solve. Well, I can put this into matrix form, 2 minus lambda, lambda minus 2, xy equals 0. Now, how do I solve a linear system? Matrix times xy equals 0. Well, I always have an obvious solution, x and y both equal to 0.  is not free. So we want another solution. So the trivial solution, 0, 0, does not solve the constraint equation, xy equals free. So we want another solution. When do we have another solution? Well, when the determinant of a matrix is 0,  So we have other solutions exist only if the determinant of a matrix is 0, and where M is k.  well, that seems to be negative 4 plus lambda squared. So that's 0 exactly when lambda squared equals 4, which is lambda is plus or minus 2. So already you see here it's at a level of difficulty that's a little bit much for an exam, but perfectly fine for a problem set or for a beautiful lecture like this one.  OK, so how do we deal with, well, we have two cases to look at, lambda equals 2, or lambda equals minus 2? Let's start with lambda equals 2. If I set lambda equals 2, what does this equation become? Well, it becomes x equals y. This one becomes y equals x. Well, they seem to be the same, OK? x equals y. And then the equation xy equals 3 becomes x.  x squared equals 3. So I have two solutions.  x equals negative y, that means x equals negative x.  are these two points, root 3, root 3, are negative,  is, indeed, twice the yellow vector, gradient g.  are guaranteed to be absolute minima or maxima. They are guaranteed to be somehow critical points under the constraint. So, that means, you know, if you were able to solve and eliminate a variable, they would be critical points. So, then you have the same problem, as with critical points, are they maxima or minima? And the answer is, well, we won't know until we check. OK. More questions?  So what is a Lagrange multiplier? Well, it's this number lambda. It's called the multiplier here. OK? It's multiplier because it's what you have to multiply in gradient of g by to get gradient of f.  So let's try to see why is this method valid.  find min or max. So what that means is that if I move on the level g equals constant, then the value of f should only increase or only decrease. But it means in particular to first order it will not change. So at an unconstraint min or max, the partial derivatives are 0.  So only in the allowed directions, and the allowed directions are those that stay on the level surface, g equals constant. OK, so in any direction along the level set, g equals c,  f must be 0. That's what happens at min and m  So that means for any m of x,  direction that's tangent to the constraint level, g equals c. We must have ds in the direction of you equals 0.  now I mean for every variables, just to give you different examples. So here I have a level surface, g equals c. I'm at my point, and if I move in any direction that's on the level surface, so I move in the direction you that's tangent to the level surface, then the right of change of f in that direction should be 0.  Now, remember what's the formula for this guy? Well, we've seen that this guy is actually Regent f.u. So that means any such vector u must be perpendicular to the Regent of f.  So, well, so that means that the gradient of f should be perpendicular to anything that's tangent to this level.  that's the gradient of g. So we conclude that the gradient of f must be  to the gradient of g, because both are probably clear, are two-level set of g. OK, I see confused faces. So let me tell you again where that comes from. So we say if we have a constant minimum or maximum, if we move in the level set of g, f doesn't change. Well, it doesn't change to first order. Remember, it's the same idea as when you're looking for a minimum, you set the derivative equal to 0. OK, so the derivative in any direction, tangent to 1,  g equals c, should be the direction or derivative of f, in any such direction, should be 0. That's what we mean by a critical point of f. And so that means that any vector you had, any unit vector, tangent to the level set of g, is going to be perpendicular to the gradient of f. So that means that the gradient of f is perpendicular,  to the level set of g. If you want, that means the level sets of f and g are tensioned to each other. So that's just defying what we've observed on the picture, that the two level sets have to be tensioned to each other at the constant minimum or maximum. Does that make a little bit of sense? I see at least a few faces noting. So I take that for, I take that to be a positive picture.  and so. OK, so since I've been asked by several of you, how do I know if it's a maximum or a minimum?  or a maximum. So, how do we do it?  there's specific directions that are tangent to the level of g. And we don't really, I mean, we don't want to bother to try to define directional second derivatives, not to mention that actually it wouldn't work. There is a criterion that it's much more complicated than that. So basically, the answer for us is we don't have a second derivative test in this situation. So what are we left with? Well, we're just left with comparing values. You know, say that in this problem, you found a point where f is less than 1,  f equals 3, a point where f equals 9, a point where f equals 15, well, then probably the minimum is the point where f equals 3, and the maximum is 15. Actually, in this case, well, we found minima. These two points are tied for minimum. What about the maximum? What's the maximum of f and the hyperbola? Well, it's infinity, because the point can go as far as you want from the origin.  So, the idea is if we have a good reason to believe that there should be a minimum, and it's not like at infinity or something, we are like that, then the minimum will be a solution of the Lagrange multiplier equations. So, we just look for all the solutions, and then we choose the one that gives us the lowest value. Is that good enough? OK. So, let me actually write that down.  So to find the minimum of a maximum, I'll say,  we compare the values of f at the various solutions.  OK, let's do, well, sorry, I should say also, sometimes you can just conclude, you know, by thinking geometrically. I mean, in this case, you know, when it's asking you which point is closest to the origin, you can just see that your answer is the correct one. OK, let's do an advanced example.  And that means that, well, this one I didn't actually there to put on the  And so, say that, you know, I have maybe in the xy-plane, and I have, in the xy-y, and, in the xy-y, and, in the xy-y, and, in the xy-y,  I'm giving you some triangle, and I'm going to try to build a pyramid. So I have to find where to put, because I can choose where to put the top of the pyramid. This guy will end up being behind now. And the goal is to minimize the terms  in the total surface area. OK, so first time I taught this class that was like. A few years ago, it was just before they built this data center. And then I used to motivate this problem by saying, well, Frank Gehry has gone crazy, and he's given a triangular plot of land. He wants to put a pyramid. There needs to be the right amount of volume so that you can put all the offices in there. And he wanted to be actually covered in solid blue.  And because that's expensive, the MIT administration wants him to cut the costs a bit, and so you have to minimize the total sides so that it doesn't cost too much. We'll see if MIT comes up with a triangular pyramid building. Hopefully not. Could be our next dorm. You never know. OK, anyway, it's a fine geometric record.  And let's try to think about how we can do this. So the natural way to think about it would be, well, what we have to look for first, what do we have to look for? We have to look for the position of that top point. Well, remember we know that the volume of the pyramid is one-third of a real of a base times height.  So in fact, fixing the volume, knowing that we have fixed the area of the base, means that we're fixing the height of the pyramid. So the height is completely fixed. What we have to choose, just is where do we put that top point? Do we put it smacking the middle of the triangle, or to a side, or even anywhere we want?  OK, let's call h the right. So what we could do is something like this. We say, well, we have the three points in the base.  x3 y3 is 0, this point p is the unknown point at xy, h, well, at least we know the height. And then we want to minimize the sum of the areas of these three triangles that are one here, one here, and one at the back. And areas of triangles we know how to express using length of cross product. So that becomes a function of x and y,  And you can try to minimize it, and actually, it doesn't quite work. The formulas are just too complicated. You never get there. So what happens is actually, maybe we need better coordinates. Why do we need better coordinates? That's because the geometric is kind of difficult to do if you use xy coordinates. I mean, formula for cross product is fine, but then the length of the vector will be annoying.  And, just as an proof good. So, instead, let's think about it differently. I have one more build. OK, so I claim if we do it this way, when we express then the area,  of xy, well, actually we can't solve the minimum, for the minimum. So here's another way to do it. Well, what's worked quite well for us so far is this geometric idea of, you know,  the height of these things, and I'm going to say that the R l will be the sum of three terms, which are three basis and three heights. So let's give names to these quantities. So, to be for that, it's going to be good to have the point in the xy  is directly below p. Let's call q. So, p is the point, I've called in its x, y, and h. And let's call q the point that's just below it. So, I've called in its x, y, 0. So, let's see. Let me draw a picture, actually. Let me draw a map of this thing. It's in form above. So, I have p1, p2,  P3, I have my point Q in the middle. So let's see. To know these areas, I need to know the base. Well, the base, I can decide that I know it because it's part of my given data. I know the size of this triangle that we call the lengths, A1, A2, A3. I also need to know the heights. So I need to know these lengths.  but it's a distance in space that's a little bit annoying. But maybe I can reduce it to a distance in the plane by looking instead at this distance here. So let me give names to the distances from Q to the sides. So let's call it U1, U2, and U3,  from Q to the sides. Well, now I claim I can find, actually, I need to draw one more thing. I claim I have a nice formula for the R here,  So this length here is u3, this length here is h. So what's this length here? Yeah, it's square root of u3 squared, plus h squared. And similarly for these other guys, there are square roots of a u square plus h square.  So the faces are square root of u1 square plus h square, and similarly with u2 and u3. So the side, the total side are here, is going to be, well, are here are the first faces. And 1-half of base times height plus 1-half of other base times other height,  1-half of third one. It doesn't look so much better, but, trust me, it will get better. OK, so now that's a function of three variables, u1, u2, u3. And how do we relate, u1, u2, u3 to each other? They're probably not independent. Well, let's cut this triangle here into three pieces, like that.  then each piece has a side, well, let's look at, say, the piece at the bottom.  have of a2 u2 plus 1 half of a3, u3, and that's not a constant. OK? So my three variables, u1, u3, are constrained in this way.  of a partial u1 is, well, if you do the calculation, you will see it's 1, 1, 1 over square root of u1 square plus h square. It should be lambda times what's partial g partial u1. That's one you can do in show. It's 1, 1, 1, a1. Oh, this guy is simplified. OK, if you do the same with the second one,  things simplify again, and same with the third one. Well, you will get, after simplifying, 0 3 over square root of 0 3 squared plus h  And if you think about it, that means that u1 equals u2, equals u3. See, it looked like scary equations, but the solution is very simple. So what does it mean? It means that our point, Q, should be equal distance from all three sides. That's called the n-center. So Q should be the n-center. So the next time that you have to build a golden pyramid and don't want to go broke, well, you know where to put that up.  sorry, in your way, it's not completely closed all.